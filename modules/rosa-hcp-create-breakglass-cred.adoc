// Module included in the following assemblies:
//
// * rosa_hcp/rosa-hcp-sts-creating-a-cluster-quickly.adoc

:_mod-docs-content-type: PROCEDURE
[id="rosa-hcp-sts-create-breakglass-cred_{context}"]
= Creating a break glass credential for a {hcp-title} cluster

As a {hcp-title} cluster owner, you can use the breakglass credential to gain temporary administrative client credentials to your clusters configured with custom OIDC token issuers. The temporary credentials are created in a cluster-admin kubeconfig that you can use to access the cluster in the following situations:

* Between the point at which the cluster is created and when the OIDC configuration is complete and authentication can occur through normal flows.
* If the identity provider (IdP or external OIDC) becomes unavailable or misconfigured.

.Prerequisites

* You have created a {hcp-title} cluster with an external authentication service and it is in a ready state
* You have configured Microsoft Entra ID as the cluster identity provider for your cluster.

[IMPORTANT]
====
This break-glass credential method is not a replacement for the primary identity provider.
====

.Procedure

. Create a break glass credential with one of the following commands.
** Create a break glass credential with no optional values. This method activates the interactive mode where you can provide values. If you do not enter values, the expiration timestamp will default to 7 days and the username will default to the username of the user making this request.
+
[source,terminal]
----
$ rosa create break-glass-credentials -c <cluster_name> <1>
----
<1> Replace <cluster_name> with the name of your cluster.
+
This command returns the new `kubeconfig` file.
+
.Example output
+
[source,terminal]
----
I: Enabling interactive mode
? Username (optional):
? Expiration duration (optional):
apiVersion: v1
clusters:
- cluster:
    server: <server_url>
  name: cluster
contexts:
- context:
    cluster: cluster
    namespace: default
    user: <user_name>
  name: admin
current-context: admin
kind: Config
preferences: {}
users:
- name: 9d9cd8f6-ead9-11ee-8e69-1eb8df358bc2
  user:
    client-certificate-data: <private_key>
	client-key-data: <private_key>
----
+
** Create a break glass credential providing values for the `username` and `expiration` date arguments:
+
[source,terminal]
----
$ rosa create break-glass-credential -c test-hcp --username test-username
--expiration 1h
----
+
. Check the status of the break glass credential with the following command:
+
[source,terminal]
----
$ rosa describe break-glass-credential 2a7jli9n4phe6c02ul7ti91djtv2o51d -c cluster-id â€”kubeconfig
----
+
.Example output
+
[source,terminal]
----
ID:                                    2330dbs0n8m3chkkr25gkkcd8pnj3lk2
Username:                              test-user
Expire at:                             Mar 26 2024 10:23:05 EDT
Status:                                issued
----
.Verification

* You can list the break glass credentials available for your clusters by running the following command:
+
[source,terminal]
----
$ rosa list break-glass-credential -c <cluster_name>
----
+
.Example output
+
[source,terminal]
----
ID                                USERNAME    STATUS
2330dbs0n8m3chkkr25gkkcd8pnj3lk2  test-user   issued
----
+
[NOTE]
====
You can also view the credentials in a json output by adding the -o json argument to the command.
====
